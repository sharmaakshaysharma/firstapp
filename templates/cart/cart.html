{% extends 'base/base.html' %}

{%block content%}
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f9f9f9;
    }

    h1 {
        text-align: center;
        margin-bottom: 20px;
        font-weight: bold;
        font-size: 24px;
        color: #333;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 20px;
    }

    th,
    td {
        text-align: left;
        padding: 15px;
        border-bottom: 1px solid #ddd;
    }

    th {
        background-color: #f4f4f4;
    }

    .price,
    .total {
        text-align: right;
    }

    .quantity input {
        width: 40px;
        text-align: center;
        border: 1px solid #ddd;
        border-radius: 5px;
        padding: 5px;
    }

    .summary {
        text-align: right;
        margin-top: 20px;
    }

    .summary p {
        margin: 10px 0;
    }

    .checkout-button {
        display: block;
        width: 200px;
        margin: 20px auto;
        padding: 10px;
        text-align: center;
        color: #fff;
        background-color: #000;
        text-decoration: none;
        font-weight: bold;
        border-radius: 5px;
    }

    .checkout-button:hover {
        background-color: #333;
    }

    .free-shipping {
        text-align: center;
        margin-top: 10px;
        color: green;
        font-weight: bold;
    }
</style>

<body>
    <div class="container">
        <h1>Your Cart ({{ cart_items|length }} items)</h1>
        <table>
            <thead>
                <tr>
                    <th class="scope">Item</th>
                    <th>Price</th>
                    <th>Quantity</th>
                    <th>Total</th>
                </tr>
            </thead>
            <tbody>
                {%for cart in cart_items%}
                <tr>
                    <td class="text-center font-height-bold" style="padding: 10px;">
                        <img class="card-img-top" src="{{ cart.product.image.url }}"
                            alt="Image of {{ cart.product.title }}"
                            style="max-height: 70px; max-width: 70px; object-fit: contain; border-radius: 10px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);">
                    </td>
                    <td>
                        $<span class="product-price" data-price="{{ cart.product.price }}">{{ cart.product.price}}</span>
                    </td>
                    <td>
                        <button class="minus" data-id="{{ cart.id }}" style="border-radius: 5px;">-</button>
                        <input  class="quantity" value="{{ cart.quantity }}" min="1"
                            style="width: 50px; text-align: center; font-size: small; border-radius: 5px;" data-id="{{ cart.id }}" disabled>
                        <button class="plus" data-id="{{ cart.id }}" style="border-radius: 5px;">+</button>
                    </td>                    
                    <td>
                        $<span class="total-price" data-total="{{ cart.total_price }}">{{ cart.total_price }}</span>
                    </td>
                </tr>
                {%endfor%}
            </tbody>
        </table>
        <div class="summary">

            <p><strong>Grand Total: ${{ grand_total }}</strong></p>
        </div>
        <a class="checkout-button">Check Out</a>
    </div>
</body>

<script>
    document.querySelectorAll('.plus, .minus').forEach(button => {
    button.addEventListener('click', function () {        
        const input = this.closest('td').querySelector('.quantity');
        let value = parseInt(input.value, 10);

        if (this.classList.contains('plus')) {
            value++;
        } else if (this.classList.contains('minus') && value > 1) {
            value--;
        }
        input.value = value;
        const cartId = input.getAttribute('data-id');
        updateCart(cartId, value);
    });
});

function updateCart(cartId, quantity) {    

    console.log(`Cart ${cartId} updated to quantity: ${quantity}`);
}


</script>
{%endblock%}
